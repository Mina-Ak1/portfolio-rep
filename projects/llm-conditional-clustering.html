<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Conditional Clustering Using LLMs</title>
  <meta name="description" content="Can we define an LLM to cluster the data based on a specific criteria?" />
  <link rel="stylesheet" href="../style.css" /> 
</head>
<body>
  <!-- NAV -->
  <header class="nav">
    <nav>
      <a class="brand" href="../index.html">Mina Akhondzadeh</a>
      <a href="../about.html">About me</a>
      <a href="../index.html#projects">Projects</a>
      <a href="../resume.pdf" target="_blank" rel="noopener">Resume</a>
      <a href="../contact.html">Contact</a>
    </nav>
  </header>

  <div class="layout">
    <!-- SIDEBAR (same as other project) -->
    <aside class="sidebar">
      <div class="side-group">
        <a href="../index.html"><img class="side-photo" src="../images/photo1.jpeg" alt="Mina Akhondzadeh" /></a>
        <div class="side-name" style="margin-top:10px;">Mina Akhondzadeh</div>
        <div class="side-title">Data Scientist · Orlando, FL</div>
      </div>
      <div class="side-group">
        <p class="side-cred">
          M.S. in Statistics & Data Science (UCF)<br>
          Part-time Ph.D. in Big Data Analytics
        </p>
      </div>
      <a href="../documents/aws-cert.pdf" target="_blank" rel="noopener" style="text-decoration:none; color:inherit;">
        <div class="side-group" style="display:flex; align-items:center; gap:8px;">
          <img src="../images/aws-logo.png" alt="AWS Logo" style="width:26px; height:26px;" />
          <span style="font-size:14px;">AWS Certified Cloud Practitioner</span>
        </div>
      </a>
      <div class="side-group icons">
        <a class="icon" href="https://github.com/Mina-Ak1" target="_blank" rel="noopener" aria-label="GitHub">
          <svg viewBox="0 0 24 24"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 19 4.77 5.07 5.07 0 0 0 18.91 1S17.73.65 15 2.48a13.38 13.38 0 0 0-6 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77 5.44 5.44 0 0 0 3.5 8.52c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>
        </a>
        <a class="icon" href="https://www.linkedin.com/in/mina-akhondzadeh/" target="_blank" rel="noopener" aria-label="LinkedIn">
          <svg viewBox="0 0 24 24"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
        </a>
        <div class="icon-wrap">
          <button class="icon" id="copyEmail" aria-label="Copy Email">
            <svg viewBox="0 0 24 24"><path d="M4 4h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z"></path><path d="m22 6-10 7L2 6"></path></svg>
          </button>
          <span id="emailTip" class="tooltip" role="status" aria-live="polite">Email copied</span>
        </div>
      </div>
      <div class="side-divider"></div>
      <div class="side-group">
        <h3 style="margin:0 0 8px; font-size:13px; color:var(--muted); text-transform:uppercase; letter-spacing:.6px;">Skills</h3>
        <div class="skills">
          <span class="pill">Machine Learning</span>
          <span class="pill">Statistics</span>
          <span class="pill">LLM Fine-tuning</span>
          <span class="pill">NLP</span>
          <span class="pill">Data Viz</span>
          <span class="pill">Python</span>
          <span class="pill">Flask</span>
          <span class="pill">SQL</span>
        </div>
      </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="content narrow">
      <section>
        <h1>Conditional Clustering using LLMs</h1>

        <div class="skills" style="margin: 10px 0 30px;">
          <span class="pill">Python</span>
          <span class="pill">GPT-4</span>
          <span class="pill">LLM Embeddings</span>
          <span class="pill">K-Means</span>
          <span class="pill">PCA</span>
        </div>

        <div class="hero">
          <img src="../images/pca-conditional.png" alt="Conditional Clustering" />
        </div>

        <!-- TL;DR -->
        <p class="question"><strong>TL;DR</strong></p>
        <p class="tldr">
          I gathered five short texts that can be grouped by topic, sentiment, or emotion. 
          I tested three methods: (1) task-specific LLM embeddings, (2) GPT-4 with prompts, and (3) a TF-IDF + K-Means baseline. 
          I compared how each method clusters the same inputs under different conditions. The third method does not allow for defining a condition explicitly.
        </p>

        <!-- ABOUT DATA -->
        <p class="question"><strong>About the Data</strong></p>
        <div class="answer">
          <p>
          Five short texts designed to be clusterable in multiple ways (sports/finance/science for topic; positive/neutral/negative for sentiment; joy/sadness/etc. for emotion). This makes it easy to see how the “definition of similarity” affects grouping. 
          </p>

          <ol class="tight" start="0">
            <li>“The soccer team celebrated their championship victory with a parade.”</li>
            <li>“The marathon runner collapsed just meters away from the finish line.”</li>
            <li>“Basketball players need both speed and strategy to dominate the court.”</li>
            <li>“The stock market experienced a sharp decline today, causing panic among investors.”</li>
            <li>“NASA just launched a new telescope to explore distant galaxies.”</li>
          </ol>
        </p>

        <!-- METHODS (brief) -->
        <p class="question"><strong>What did I compare?</strong></p>

        <p class="answer"><b>Task-specific LLM embeddings</b> + K-Means, using:</p>
        <ul class="answer" style="margin: 6px 0 12px; padding-left: 20px;">
          <li><code>cardiffnlp/tweet-topic-21-multi</code> for topic classification</li>
          <li><code>j-hartmann/emotion-english-distilroberta-base</code> for emotion classification</li>
          <li><code>cardiffnlp/twitter-roberta-base-sentiment</code> for sentiment classification</li>
        </ul>

        <p class="answer">
          <b>Prompt-based GPT-4 approach</b>: I used GPT-4 to generate sentence groupings based on natural language prompts specifying topic, emotion, or style. Since GPT-4 doesn’t expose its internal embeddings, I used <code>text-embedding-ada-002</code> to embed the same texts and perform clustering aligned with each condition.
        </p>



        <p class="answer">
          <b>Classical baseline</b>: TF-IDF + K-Means (no way to define the condition directly).
        </p>

        <!-- OLD PLOT SET (kept) -->
        <p class="question"><strong>PCA views of the embeddings</strong></p>
        <p class="answer">Topic shows tighter, clearer groupings; sentiment and emotion are more diffuse (they are more subjective), so clusters spread out more. </p>
        <div class="img-block">
          <img class="small-img" src="../images/pca-conditional.png" alt="PCA visualization of topic, sentiment, and emotion embeddings" />
        </div>

        <p class="question"><strong>K-Means on LLM embeddings vs. TF-IDF</strong></p>
        <p class="answer">
          Clustering with LLM embeddings often grouped the sentences in ways that matched the intended condition (like topic or emotion). In contrast, TF-IDF sometimes grouped unrelated sentences together just because they shared common words.
        </p>

        <div class="img-block"><img class="medium-img" src="../images/kmeans-llm-3panels.png" alt="K-Means on topic/sentiment/emotion embeddings" /></div>
        <div class="img-block"><img class="small-img" src="../images/kmeans-tfidf.png" alt="K-Means on TF-IDF baseline" /></div>


        <p class="question"><strong>Do the embedding spaces agree?</strong></p>
        <p class="answer">
          Not exactly. Each LLM I used was fine-tuned on a specific task (topic, sentiment, or emotion) and trained to produce embeddings aligned with those labels. As a result, the same sentences cluster differently depending on which model is used. For conditional clustering, using task-specific LLMs gives you embeddings that naturally reflect the condition you are interested in.
        </p>



        <p class="question"><strong>Takeaways</strong></p>
        <ul class="answer" style="padding-left:18px;">
          <li>LLMs trained on a specific task give embeddings that naturally reflect that task, so clustering works better.</li>
          <li>TF-IDF is simple but does not account for meaning, it just picks up on word overlap, which can be misleading.</li>
          <li>Using GPT-4 with prompts is helpful when no pre-trained model fits, as long as the condition can be explained clearly.</li>
        </ul>


      </section>


      <footer>
        For details you can visit my <a href="https://github.com/Mina-Ak1/Conditional-Clustering" target="_blank">GitHub repository</a> · © <span id="year"></span> Mina Akhondzadeh
      </footer>
    </main>
  </div>



  <script>
    // year stamp
    document.getElementById("year").textContent = new Date().getFullYear();
    // Copy-to-clipboard tooltip
    const copyBtn = document.getElementById("copyEmail");
    const tip = document.getElementById("emailTip");
    if(copyBtn){
      copyBtn.addEventListener("click", () => {
        navigator.clipboard.writeText("mina.akhndzd@gmail.com").then(() => {
          tip.classList.add("show"); setTimeout(()=> tip.classList.remove("show"), 1100);
        });
      });
    }
  </script>
</body>
</html>
